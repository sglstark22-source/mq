<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCQ WEB Practice</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>MCQ WEB APP</h1>
            <p class="subtitle">Multiple Choice Questions Practice</p>
            <div class="user-info" id="user-info" style="display: none;">
                <span id="user-name"></span>
                <button id="theme-toggle" class="btn btn-small">Theme</button>
                <button id="logout-btn" class="btn btn-small">Logout</button>
            </div>
        </header>

        <!-- Login Screen -->
        <div id="login-screen" class="screen active">
            <div class="login-container">
                <h2>Login to MCQ Portal</h2>
                <div id="login-error" class="error-message" style="display: none;"></div>
                <form id="login-form">
                    <div class="form-group">
                        <label for="username">Username</label>
                        <input type="text" id="username" name="username" required autocomplete="username">
                    </div>
                    <div class="form-group">
                        <label for="password">Password</label>
                        <input type="password" id="password" name="password" required autocomplete="current-password">
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">Login</button>
                </form>
                <div class="login-footer">
                    <p>Don't have an account? <a href="#" id="show-register">Register as Student</a></p>
                </div>
            </div>

            <!-- Registration Form -->
            <div id="register-container" class="login-container" style="display: none;">
                <h2>Register as Student</h2>
                <div id="register-error" class="error-message" style="display: none;"></div>
                <div id="register-success" class="success-message" style="display: none;"></div>
                <form id="register-form">
                    <div class="form-group">
                        <label for="reg-name">Full Name</label>
                        <input type="text" id="reg-name" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="reg-username">Username</label>
                        <input type="text" id="reg-username" name="username" required minlength="3">
                    </div>
                    <div class="form-group">
                        <label for="reg-password">Password</label>
                        <input type="password" id="reg-password" name="password" required minlength="6">
                    </div>
                    <div class="form-group">
                        <label for="reg-confirm-password">Confirm Password</label>
                        <input type="password" id="reg-confirm-password" name="confirmPassword" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">Register</button>
                </form>
                <div class="login-footer">
                    <p>Already have an account? <a href="#" id="show-login">Login</a></p>
                </div>
            </div>
        </div>

        <!-- Admin Dashboard -->
        <div id="admin-dashboard" class="screen">
            <div class="admin-header">
                <h2>Admin Dashboard</h2>
                <div class="admin-stats">
                    <div class="stat-card">
                        <h3 id="total-sets">0</h3>
                        <p>Question Sets</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="total-questions-admin">0</h3>
                        <p>Total Questions</p>
                    </div>
                </div>
            </div>

            <div class="admin-content">
                <div class="admin-tabs">
                    <button class="tab-btn active" data-tab="questions">Manage Questions</button>
                    <button class="tab-btn" data-tab="results">View Results</button>
                </div>

                <!-- Questions Management Tab -->
                <div id="tab-questions" class="tab-content active">
                    <div class="admin-actions">
                        <select id="set-selector">
                            <option value="">Select Question Set</option>
                        </select>
                        <button id="add-set-btn" class="btn btn-secondary">Add New Set</button>
                        <button id="delete-set-btn" class="btn btn-danger">Delete Set</button>
                        <button id="promote-student-btn" class="btn btn-primary">Promote Student</button>
                        <button id="add-question-btn" class="btn btn-primary">Add New Question</button>
                    </div>
                    <div id="questions-list" class="questions-list">
                        <!-- Questions will be displayed here -->
                    </div>
                </div>

                <!-- Results Tab -->
                <div id="tab-results" class="tab-content">
                    <div id="results-list" class="results-list">
                        <p>No results available yet.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Home Screen -->
        <div id="home-screen" class="screen">
            <div class="welcome-section">
                <h2>Welcome to MCQ Practice Portal</h2>
                <p>Select a question set to begin your practice:</p>
                <div class="home-actions">
                    <button id="view-leaderboard-btn" class="btn btn-primary">üèÜ View Leaderboard</button>
                </div>
            </div>
            
            <div id="question-sets" class="question-sets"></div>
        </div>

        <!-- Quiz Screen -->
        <div id="quiz-screen" class="screen">
            <div class="quiz-header">
                <div class="quiz-info">
                    <h2 id="current-set-name">Question Set</h2>
                    <div class="timer-container">
                        <span class="timer-label">Time Remaining:</span>
                        <span id="timer" class="timer">60:00</span>
                    </div>
                </div>
                <div class="progress-bar">
                    <div id="progress" class="progress-fill"></div>
                </div>
                <div class="question-counter">
                    <span id="current-question">1</span> / <span id="total-questions">25</span>
                </div>
            </div>

            <div class="question-container">
                <div class="question-number">Question <span id="q-number">1</span></div>
                <h3 id="question-text" class="question-text"></h3>
                
                <div id="options-container" class="options-container">
                    <!-- Options will be dynamically inserted here -->
                </div>

                <div class="navigation-buttons">
                    <button id="prev-btn" class="btn btn-secondary" disabled>Previous</button>
                    <button id="next-btn" class="btn btn-primary">Next</button>
                    <button id="submit-btn" class="btn btn-success" style="display: none;">Submit Exam</button>
                </div>
            </div>

            <div class="question-palette">
                <h4>Question Palette</h4>
                <div id="question-palette-grid" class="palette-grid">
                    <!-- Question numbers will be dynamically inserted here -->
                </div>
            </div>
        </div>

        <!-- Results Screen -->
        <div id="results-screen" class="screen">
            <div class="results-container">
                <h2>Exam Results</h2>
                <div class="score-card">
                    <div class="score-circle">
                        <div class="score-value" id="score-percentage">0%</div>
                        <div class="score-label">Score</div>
                    </div>
                    <div class="score-details">
                        <div class="detail-item">
                            <span class="detail-label">Total Questions:</span>
                            <span class="detail-value" id="total-qs">0</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Correct Answers:</span>
                            <span class="detail-value correct" id="correct-answers">0</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Wrong Answers:</span>
                            <span class="detail-value wrong" id="wrong-answers">0</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Unanswered:</span>
                            <span class="detail-value" id="unanswered">0</span>
                        </div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button id="review-btn" class="btn btn-primary">Review Answers</button>
                    <button id="retake-btn" class="btn btn-secondary">Take Another Set</button>
                </div>

                <div id="review-section" class="review-section" style="display: none;">
                    <h3>Answer Review</h3>
                    <div id="review-questions">
                        <!-- Review content will be inserted here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Leaderboard Screen -->
        <div id="leaderboard-screen" class="screen">
            <div class="leaderboard-container">
                <div class="leaderboard-header">
                    <h2>üèÜ Leaderboard</h2>
                    <p>Top performers across all question sets</p>
                </div>

                <div class="leaderboard-filters">
                    <div class="filter-group">
                        <label for="leaderboard-filter-set">Filter by Set:</label>
                        <select id="leaderboard-filter-set">
                            <option value="">All Sets</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="leaderboard-top-n">Show Top:</label>
                        <select id="leaderboard-top-n">
                            <option value="10">Top 10</option>
                            <option value="20">Top 20</option>
                            <option value="50">Top 50</option>
                            <option value="100">Top 100</option>
                        </select>
                    </div>
                    <button id="clear-leaderboard-filters" class="btn btn-secondary">Clear Filters</button>
                </div>

                <div id="leaderboard-content" class="leaderboard-content">
                    <!-- Leaderboard will be displayed here -->
                </div>

                <div class="leaderboard-actions">
                    <button id="back-to-home-btn" class="btn btn-primary">Back to Home</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Question Editor Modal -->
    <div id="question-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2 id="modal-title">Add Question</h2>
            <form id="question-form">
                <input type="hidden" id="edit-question-id">
                <input type="hidden" id="edit-question-set-id">
                <div class="form-group">
                    <label for="modal-question-text">Question</label>
                    <textarea id="modal-question-text" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label>Options</label>
                    <input type="text" class="option-input" id="option-0" placeholder="Option 1" required>
                    <input type="text" class="option-input" id="option-1" placeholder="Option 2" required>
                    <input type="text" class="option-input" id="option-2" placeholder="Option 3" required>
                    <input type="text" class="option-input" id="option-3" placeholder="Option 4" required>
                </div>
                <div class="form-group">
                    <label for="correct-answer">Correct Answer</label>
                    <select id="correct-answer" required>
                        <option value="0">Option 1</option>
                        <option value="1">Option 2</option>
                        <option value="2">Option 3</option>
                        <option value="3">Option 4</option>
                    </select>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" id="cancel-question-btn">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Question</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Set Editor Modal -->
    <div id="set-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Add Question Set</h2>
            <form id="set-form">
                <div class="form-group">
                    <label for="set-name">Set Name</label>
                    <input type="text" id="set-name" required>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" id="cancel-set-btn">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Set</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Promote Student Modal -->
    <div id="promote-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Promote Student to Admin</h2>
            <form id="promote-form">
                <div class="form-group">
                    <label for="promote-username">Student Username</label>
                    <input type="text" id="promote-username" placeholder="student username" required>
                </div>
                <div class="form-group">
                    <label>Students</label>
                    <div id="promote-student-list"></div>
                </div>
                <div class="form-group">
                    <label>Admins</label>
                    <div id="promote-admin-list"></div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" id="cancel-promote-btn">Cancel</button>
                    <button type="submit" class="btn btn-primary">Promote</button>
                </div>
            </form>
        </div>
    </div>

    <script src="auth.js"></script>
    <script src="questions.js"></script>
    <script src="script.js"></script>
</body>
</html>
